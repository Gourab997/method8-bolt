import{y as F,j as e,f as L,A as N,t as U,o as $,a as B,B as O,H as V,r as q}from"./index-oREoqiUU.js";import{U as b,r as h,V as H,Y as K}from"./vendor-BBLzNF_7.js";import{u as W,a as Y,b as Z,c as G}from"./module-api-CYbA2mdi.js";import{c as w,y as Q,F as j,b as J,E as X,I as S,A as ee,T as M,P as te,g as se,B as C,r as ae,D as ne,a as ie,M as re,R as _,C as x}from"./antd-BTTnWTpg.js";/**
 * @license hugeicons-react v0.2.0
 *
 * See the LICENSE file in the root directory of this source tree.
 */const oe=F("EyeIcon",[["path",{d:"M2 8C2 8 6.47715 3 12 3C17.5228 3 22 8 22 8",stroke:"currentColor",key:"k0"}],["path",{d:"M21.544 13.045C21.848 13.4713 22 13.6845 22 14C22 14.3155 21.848 14.5287 21.544 14.955C20.1779 16.8706 16.6892 21 12 21C7.31078 21 3.8221 16.8706 2.45604 14.955C2.15201 14.5287 2 14.3155 2 14C2 13.6845 2.15201 13.4713 2.45604 13.045C3.8221 11.1294 7.31078 7 12 7C16.6892 7 20.1779 11.1294 21.544 13.045Z",stroke:"currentColor",key:"k1"}],["path",{d:"M15 14C15 12.3431 13.6569 11 12 11C10.3431 11 9 12.3431 9 14C9 15.6569 10.3431 17 12 17C13.6569 17 15 15.6569 15 14Z",stroke:"currentColor",key:"k2"}]]),{Text:le}=w,de={display:"inline-flex",alignItems:"center",padding:"2px 8px",border:"1px solid #1DC300",borderRadius:"8px",backgroundColor:"#f6fff6"},ce={fontSize:"14px",fontWeight:500,marginRight:6},ue={color:"#1DC300",fontWeight:700,fontSize:"16px"},me=({title:n,value:i,precision:a=0,suffix:r="%"})=>e.jsxs("div",{style:de,children:[e.jsx(le,{style:ce,children:n}),e.jsx(Q,{precision:a,suffix:r,value:i,valueStyle:ue})]}),pe={in_progress:"gold",completed:"green"},ge=({editing:n,dataIndex:i,title:a,inputType:r,record:u,index:c,children:m,...o})=>{const p=i==="tags"?e.jsx(ie,{mode:"tags",style:{width:"100%"},tokenSeparators:[" "]}):e.jsx(S,{});return e.jsx("td",{...o,children:n?e.jsx(j.Item,{name:i,rules:i==="tags"?[]:[{required:!0,message:`Please Input ${a}!`}],style:{margin:0},children:p}):m})},ye=({assessmentModulesData:n,isLoading:i,pagination:a,handleTableChange:r})=>{const u=b(),[c]=j.useForm(),[m,o]=h.useState(""),[p,{isLoading:l}]=W(),[k,{isLoading:f}]=Y(),d=t=>t.key===m,y=t=>{c.setFieldsValue({name:"",tags:[],...t}),o(t.key)},I=()=>{o("")},T=async t=>{try{const s=await c.validateFields();await p({id:t,...s}),o("")}catch{}},A=t=>{re.confirm({title:"Are you sure you want to delete this assessment?",content:"This action cannot be undone.",okText:"Yes, delete it",okType:"danger",cancelText:"No, keep it",onOk:async()=>{try{await k(t.key).unwrap()}catch{}}})},v=t=>{u(`/module_preview/${t.key}`)},R=[{title:"Module Name",dataIndex:"name",key:"name",editable:!0,render:(t,s)=>d(s)?e.jsx(j.Item,{name:"name",rules:[{required:!0,message:"Please enter a name"}],style:{margin:0},children:e.jsx(S,{})}):e.jsx(H,{style:{color:"inherit"},to:`/module-builder/${s.key}`,children:t})},{title:"Facilitator",dataIndex:"facilitator_name",key:"facilitator_name",render:t=>e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(ee,{style:{marginRight:8,backgroundColor:N[t.charAt(0).toUpperCase()]},children:t.charAt(0).toUpperCase()}),t]})},{title:"Tags",key:"tags",dataIndex:"tags",editable:!0,render:t=>e.jsx("span",{children:t.map(s=>e.jsx(M,{children:s.toUpperCase()},s))})},{title:"Created At",dataIndex:"created_at",key:"created_at"},{title:"Status",key:"status",dataIndex:"status",render:t=>e.jsx(M,{color:pe[t],children:t.charAt(0).toUpperCase()+t.slice(1).replace("_"," ")})},{title:"Maturity Score",key:"maturity_score",dataIndex:"maturity_score",render:t=>e.jsx(te,{percent:t,strokeColor:se[5]})},{title:"Action",key:"action",render:(t,s)=>{if(d(s))return e.jsxs("span",{children:[e.jsx(C,{onClick:()=>T(s.key),style:{marginRight:8},type:"primary",children:"Save"}),e.jsx(C,{onClick:I,children:"Cancel"})]});const z=({key:g,domEvent:P})=>{P.stopPropagation(),g==="1"?y(s):g==="2"?v(s):g==="3"&&A(s)},D=[{key:"1",label:e.jsxs("span",{children:[e.jsx(U,{size:14,style:{marginRight:"10px"}}),"Edit"]})},{key:"2",label:e.jsxs("span",{children:[e.jsx(oe,{size:14,style:{marginRight:"10px"}}),"Preview"]})},{key:"3",label:e.jsxs("span",{style:{color:ae[5]},children:[e.jsx($,{size:14,style:{marginRight:"10px"}}),"Delete"]})}];return e.jsx(ne,{menu:{items:D,onClick:z},trigger:["click"],children:e.jsx(C,{icon:e.jsx(B,{size:20}),onClick:g=>g.stopPropagation(),type:"text"})})}}].map(t=>t.editable?{...t,onCell:s=>({record:s,inputType:"text",dataIndex:t.dataIndex,title:t.title,editing:d(s)})}:t),E=n?.data?.assessment_modules.map(t=>({key:t.id,name:t.name,tags:t.tags,status:t.status,created_at:L(new Date(t.created_at),"MMMM d, yyyy"),maturity_score:t.maturity_score,facilitator_name:t.facilitator_name}))||[];return e.jsx(j,{component:!1,form:c,children:e.jsx(J,{columns:R,components:{body:{cell:ge}},dataSource:E,loading:i||l||f,locale:{emptyText:e.jsx(X,{description:"No data"})},onChange:r,onRow:t=>({onClick:s=>{s.target.closest(".ant-dropdown-trigger")||d(t)||u(`/edit_module/${t.key}`)},style:{cursor:"pointer"}}),pagination:{position:["bottomRight"],current:a.page,pageSize:a.limit,total:n?.data?.pagy?.items}})})},{Title:xe}=w,_e=()=>{const{assessment_id:n}=K(),i=b(),{setItems:a}=h.useContext(O),[r,u]=h.useState({page:1,limit:12}),[c,{isLoading:m}]=Z(),{data:o,isLoading:p}=G({assessmentId:n,page:r.page,limit:r.limit}),l=o?.data?.assessment;h.useEffect(()=>(l&&a([{title:"Assessments",href:"/assessments"},{title:l.name}]),()=>{a([])}),[l,a]);const k=d=>{u({page:d.current,limit:d.pageSize})},f=async()=>{const y=(await c(n).unwrap())?.data?.assessment_module?.id;y&&i(`/edit_module/${y}`)};return e.jsxs(e.Fragment,{children:[e.jsx(V,{children:e.jsx("title",{children:l?.name||"Modules"})}),e.jsxs(_,{align:"middle",justify:"space-between",style:{marginBottom:24},children:[e.jsx(x,{children:e.jsxs(_,{align:"middle",gutter:16,children:[e.jsx(x,{children:e.jsx(xe,{level:2,style:{margin:0},children:l?.name})}),e.jsx(x,{children:e.jsx(me,{title:"Total Maturity Score",value:l?.maturity_score})})]})}),e.jsx(x,{children:e.jsx(C,{icon:e.jsx(q,{size:16}),loading:m,onClick:f,size:"large",type:"primary",children:"New Module"})})]}),e.jsx(ye,{assessmentModulesData:o,handleTableChange:k,isLoading:p,pagination:r})]})};export{_e as default};
